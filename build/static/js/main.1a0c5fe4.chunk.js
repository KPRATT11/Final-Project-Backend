(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{110:function(e,t,n){},111:function(e,t,n){"use strict";n.r(t);var c=n(0),s=n.n(c),o=n(30),i=n.n(o),a=(n(74),n(75),n(19)),r=n(8),l=n(16),u=n(5),j=n(12),d=n.n(j),b=n(24),h=n(6),m=n.n(h);function f(){return(f=Object(b.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("/api/currentUser");case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return console.log("yeahhh"),Object(l.useQuery)("user",(function(){return function(){return f.apply(this,arguments)}()}))}function p(){return(p=Object(b.a)(d.a.mark((function e(t){var n,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("/api/allPostsOfCommunity?id=".concat(t));case 2:return n=e.sent,c=n.data,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return Object(l.useQuery)("posts",(function(){return function(e){return p.apply(this,arguments)}(e)}),{staleTime:2e3})}function g(){return(g=Object(b.a)(d.a.mark((function e(t){var n,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("/api/community?id=".concat(t));case 2:return n=e.sent,c=n.data,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return Object(l.useQuery)("singleCommunity",(function(){return function(e){return g.apply(this,arguments)}(e)}))}function w(){return(w=Object(b.a)(d.a.mark((function e(t){var n,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>0)){e.next=8;break}return e.next=3,m.a.get("/api/post?id=".concat(t));case 3:return n=e.sent,c=n.data,e.abrupt("return",c);case 8:return e.abrupt("return");case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){return Object(l.useQuery)(["singlePost",e],(function(){return function(e){return w.apply(this,arguments)}(e)}),{staleTime:2e4})}function y(){return(y=Object(b.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("/api/followedCommunities");case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return Object(l.useQuery)("subscribedCommunities",(function(){return function(){return y.apply(this,arguments)}()}))}function k(){return(k=Object(b.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("/api/reccomendedCommunities");case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(){return Object(l.useQuery)("reccomendedCommunities",(function(){return function(){return k.apply(this,arguments)}()}))}function S(){return(S=Object(b.a)(d.a.mark((function e(t){var n,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("/api/searchedCommunities?searchQuery=".concat(t));case 2:return n=e.sent,c=n.data,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return Object(l.useQuery)(["searchedCommunities",e],(function(){return function(e){return S.apply(this,arguments)}(e)}))}var L=n(22),E=n.n(L),D=n(1),U=function(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),s=n[0],o=n[1],i=Object(c.useState)(""),a=Object(u.a)(i,2),r=a[0],l=a[1];return Object(D.jsxs)("div",{className:"form",children:[Object(D.jsx)("h1",{children:"Create a new Community"}),Object(D.jsx)("h2",{children:"Community Name"}),Object(D.jsx)("input",{className:"form-input",onChange:function(e){o(e.target.value)},type:"text",value:s}),Object(D.jsx)("h2",{children:"Community Description"}),Object(D.jsx)("textArea",{cols:48,rows:12,className:"form-input",onChange:function(e){l(e.target.value)},value:r,children:r}),Object(D.jsx)("button",{className:"submit",onClick:function(){s.length>8&&r.length>8&&e.submitCommunity(s,r)},children:"Submit Community"})]})},z=n(115),V=function(){var e=O(),t=e.isLoading,n=e.data,s=Object(c.useState)(!1),o=Object(u.a)(s,2),i=o[0],r=o[1],l=N().refetch;if(t)return Object(D.jsx)("h1",{children:"Loading"});console.log(n);var j=function(e,t){m.a.post("/api/community",{title:e,sidebar:t}).then((function(){r(!1),l()}))};return Object(D.jsxs)("div",{className:"bg-primary f-width top-bar",children:[Object(D.jsx)("button",{className:"top-bar-button round smooth-shadow-subtle",onClick:function(){r(!0)},children:"New Community"}),Object(D.jsx)(a.b,{to:"/",children:Object(D.jsx)(z.a,{className:"top-bar-home",size:78,weight:"fill",color:"#ffffff"})}),Object(D.jsxs)("div",{children:[Object(D.jsxs)("p",{className:"top-bar-user",children:["Hello ",n.logged_in?n.username:"Loading User"]}),n.logged_in?Object(D.jsx)("a",{className:"log-button",href:"http://localhost:2000/logout",children:"logout"}):Object(D.jsx)("a",{className:"log-button",href:"http://localhost:2000/login",children:"login/signup"})]}),Object(D.jsx)(E.a,{overlayClassName:"modal-overlay",className:"modal smooth-shadow",onRequestClose:function(){r(!1)},isOpen:i,children:Object(D.jsx)(U,{submitCommunity:function(e,t){j(e,t)}})})]})};var A=function(e){var t=new Date(e),n=(new Date-t)/1e3/60;return n<1?"< 1 min ago":n<60?"".concat(Math.floor(n)," mins ago"):n<1440?"".concat(Math.floor(n/60)," hours ago"):"".concat(Math.floor(n/60/24)," days ago")},Q=n(116),R=n(21),B=function(e){var t=e.details,n=e.handlePostClick,c=e.place;return Object(D.jsxs)(R.a.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.1*c,duration:.1,stiffness:500},className:"preview-post round smooth-shadow-subtle",onClick:function(){n(t.id)},children:[Object(D.jsx)("p",{className:"preview-post-owns",children:t.userOwns&&Object(D.jsx)(Q.a,{size:28,color:"#ffd900",weight:"fill"})}),Object(D.jsx)("h2",{children:t.title}),Object(D.jsx)("p",{children:t.contentPreview}),Object(D.jsx)("p",{children:A(t.postedAt)})]})},T=function(e){var t=x(Object(r.f)().comm_id),n=t.isLoading,c=t.data;if(console.log(c),n)return Object(D.jsx)("h1",{children:"Loading"});var s;return Object(D.jsx)("div",{className:"preview-post-container",children:(s=c,s.sort((function(e,t){return t.score-e.score})).map((function(t,n){return Object(D.jsx)(B,{handlePostClick:e.handlePostClick,place:n,details:{contentPreview:(c=t.content,c.length<40?c:"".concat(c.substring(0,37),"...")),userOwns:t.userOwns,title:t.title,id:t.id,score:t.score,postedAt:t.posted_at}},t.id);var c})))})},F=function(e){var t=Object(c.useState)(e.initialCommentValue),n=Object(u.a)(t,2),s=n[0],o=n[1];return Object(D.jsxs)("div",{className:"form",children:[Object(D.jsx)("textArea",{cols:48,rows:12,className:"form-input",onChange:function(e){o(e.target.value)},value:s,children:s}),Object(D.jsx)("button",{className:"submit",onClick:function(){s.length>8&&e.handleEdit(s)},children:"EDIT"})]})},q=n(117),I=n(118),M=n(119),J=n(120),H=function(e){var t=e.data,n=e.refetchPost,s=e.logged_in,o=e.place,i=Object(c.useState)(!1),a=Object(u.a)(i,2),r=a[0],l=a[1],j=function(e){"false"===t.hasUserVoted?b(e):t.hasUserVoted.is_like===e?d(!0):t.hasUserVoted.is_like!==e&&(d(!1),b(e))},d=function(e){m.a.delete("/api/vote",{data:{for_post:!1,target_id:t.id}}).then((function(){e&&n()}))},b=function(e){m.a.post("/api/vote",{is_like:e,for_post:!1,target_id:t.id}).then((function(e,t){n()}))},h=function(){m.a.delete("/api/comment?id=".concat(t.id)).then((function(e){n()}))};return Object(D.jsxs)(R.a.div,{initial:{x:850},animate:{x:0},transition:{type:"spring",delay:.1*o,stiffness:200,mass:2,damping:30},className:"comment round smooth-shadow-small",children:[Object(D.jsxs)("div",{className:"comment-info-container",children:[Object(D.jsxs)("p",{className:"comment-author",children:["By ",t.username]}),Object(D.jsx)("p",{className:"comment-date",children:A(t.submitted_at)})]}),Object(D.jsx)("p",{className:"comment-content",children:t.content}),Object(D.jsxs)("div",{className:"comment-function-buttons",children:[s&&Object(D.jsxs)("div",{children:[Object(D.jsx)("button",{className:"vote-button-comment",onClick:function(){j(!0)},style:{backgroundColor:!0===t.hasUserVoted.is_like?"#F24236":"#F8938C"},children:Object(D.jsx)(q.a,{color:"#ffffff",size:24,weight:"fill"})}),Object(D.jsx)("button",{className:"vote-button-comment",onClick:function(){j(!1)},style:{backgroundColor:!1===t.hasUserVoted.is_like?"#2E86AB":"#5EB1D4"},children:Object(D.jsx)(I.a,{color:"#ffffff",size:24,weight:"fill"})})]}),Object(D.jsxs)("div",{children:[t.userOwns&&Object(D.jsx)("button",{className:"post-top-function-button",onClick:function(){l("true")},children:Object(D.jsx)(M.a,{size:22,color:"#eeeeec",weight:"fill"})}),t.userOwns&&Object(D.jsx)("button",{className:"post-top-function-button",onClick:function(){h()},children:Object(D.jsx)(J.a,{size:22,color:"#eeeeec",weight:"fill"})})]})]}),Object(D.jsx)(E.a,{overlayClassName:"modal-overlay",className:"modal smooth-shadow",isOpen:r,onRequestClose:function(){l(!1)},children:Object(D.jsx)(F,{handleEdit:function(e){m.a.patch("/api/comment",{id:t.id,content:e}).then((function(){l(!1),n()}))},initialCommentValue:t.content})})]})},Y=function(e){var t;return Object(D.jsx)("div",{style:{width:"90%",margin:"auto"},children:(t=e.replies,t.sort((function(e,t){return t.score-e.score})).map((function(t,n){return Object(D.jsx)(H,{place:n,logged_in:e.logged_in,refetchPost:e.refetchPost,data:t},t.id)})))})},G=function(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),s=n[0],o=n[1];return Object(D.jsxs)("div",{className:"form",children:[Object(D.jsx)("h1",{children:"Reply"}),Object(D.jsx)("h2",{children:"Content"}),Object(D.jsx)("textArea",{cols:48,rows:12,className:"form-input",onChange:function(e){o(e.target.value)},value:s}),Object(D.jsx)("button",{className:"submit",onClick:function(){s.length>8&&e.submitNewReply(s)},children:"REPLY"})]})},K=function(e){var t=Object(c.useState)(e.initialTitle),n=Object(u.a)(t,2),s=n[0],o=n[1],i=Object(c.useState)(e.initialContent),a=Object(u.a)(i,2),r=a[0],l=a[1];return Object(D.jsxs)("div",{children:[Object(D.jsx)("input",{onChange:function(e){o(e.target.value)},value:s,type:"text"}),Object(D.jsx)("textArea",{onChange:function(e){l(e.target.value)},value:r,children:r}),Object(D.jsx)("button",{onClick:function(){s.length>8&&r.length>8&&e.editPost(s,r)},children:"EDIT"})]})},W=n(121),X=function(e){var t=e.postID,n=e.setBlank,s=Object(r.f)().comm_id,o=C(t),i=o.isLoading,a=o.data,l=o.refetch,j=x(s).refetch,d=Object(c.useState)(!1),b=Object(u.a)(d,2),h=b[0],f=b[1],O=Object(c.useState)(!1),p=Object(u.a)(O,2),g=p[0],v=p[1];if(""===t)return Object(D.jsx)("h1",{children:"Select A Post"});if(i)return Object(D.jsx)("h1",{children:"Loading"});var w=function(e){"false"===a.hasUserVoted?N(e):a.hasUserVoted.is_like===e?y(!0):a.hasUserVoted.is_like!==e&&(y(!1),N(e))},y=function(e){m.a.delete("/api/vote",{data:{for_post:!0,target_id:t}}).then((function(){e&&l()}))},N=function(e){m.a.post("/api/vote",{is_like:e,for_post:!0,target_id:t}).then((function(e,t){l()}))},k=function(){m.a.delete("/api/post?id=".concat(t)).then((function(e){n(),l(),j()}))},_=function(e,n){m.a.patch("/api/post",{id:t,title:e,content:n}).then((function(){v(!1),l()}))};return Object(D.jsxs)("div",{className:"focused-post-container ",children:[Object(D.jsxs)(R.a.div,{initial:{y:6350,scale:0},animate:{y:0,scale:1},transition:{type:"spring",damping:30,stiffness:300},className:"focused-post round smooth-shadow-small scale-in-top",children:[a.userOwns&&Object(D.jsx)("button",{className:"post-top-function-button",onClick:function(){v(!0)},children:Object(D.jsx)(M.a,{size:22,color:"#eeeeec",weight:"fill"})}),a.userOwns&&Object(D.jsx)("button",{className:"post-top-function-button",onClick:function(){k()},children:Object(D.jsx)(J.a,{size:22,color:"#eeeeec",weight:"fill"})}),Object(D.jsx)("p",{className:"post-date",children:A(a.posted_at)}),Object(D.jsx)("h2",{className:"post-title",children:a.title}),Object(D.jsx)("p",{className:"post-content",children:a.content}),a.logged_in&&Object(D.jsxs)("div",{className:"button-container",children:[Object(D.jsx)("button",{className:"vote-button",onClick:function(){w(!0)},style:{backgroundColor:!0===a.hasUserVoted.is_like?"#F24236":"#F8938C"},children:Object(D.jsx)(q.a,{color:"#ffffff",size:34,weight:"fill"})}),Object(D.jsx)("button",{className:"vote-button",onClick:function(){w(!1)},style:{backgroundColor:!1===a.hasUserVoted.is_like?"#2E86AB":"#5EB1D4"},children:Object(D.jsx)(I.a,{color:"#ffffff",size:34,weight:"fill"})}),Object(D.jsx)("button",{className:"post-function-button",onClick:function(){f(!0)},children:Object(D.jsx)(W.a,{size:28,color:"#eeeeec",weight:"fill"})}),Object(D.jsxs)("p",{className:"post-author",children:["By ",a.author.username]})]})]}),Object(D.jsx)("div",{className:"comment-section",children:Object(D.jsx)(Y,{logged_in:a.logged_in,refetchPost:l,replies:a.replies})}),Object(D.jsx)(E.a,{overlayClassName:"modal-overlay",className:"modal smooth-shadow",id:"id",isOpen:h,onRequestClose:function(){f(!1)},children:Object(D.jsx)(G,{submitNewReply:function(e){m.a.post("/api/comment",{content:e,target_id:t}).then((function(){f(!1),l()}))}})}),Object(D.jsx)(E.a,{overlayClassName:"modal-overlay",className:"modal smooth-shadow",isOpen:g,onRequestClose:function(){v(!1)},children:Object(D.jsx)(K,{initialTitle:a.title,initialContent:a.content,editPost:function(e,t){_(e,t)}})})]})},Z=function(e){var t=Object(c.useState)(""),n=Object(u.a)(t,2),s=n[0],o=n[1],i=Object(c.useState)(""),a=Object(u.a)(i,2),r=a[0],l=a[1];return Object(D.jsxs)("div",{className:"form",children:[Object(D.jsx)("h1",{children:"New Post"}),Object(D.jsx)("h2",{children:"Title"}),Object(D.jsx)("input",{className:"form-input",type:"text",value:s,onChange:function(e){o(e.target.value)}}),Object(D.jsx)("h2",{children:"Content"}),Object(D.jsx)("textArea",{cols:48,rows:12,className:"form-input",value:r,onChange:function(e){l(e.target.value)}}),Object(D.jsx)("button",{className:"submit",onClick:function(){s.length>8&&r.length>8&&e.submitPost(s,r)},children:"POST"})]})},$=(n(110),function(){var e=Object(r.f)().comm_id,t=v(e),n=t.isLoading,s=t.isError,o=t.data,i=t.refetch;console.log(o);var a=x(e).refetch,l=Object(c.useState)(""),j=Object(u.a)(l,2),d=j[0],b=j[1],h=Object(c.useState)(!1),f=Object(u.a)(h,2),O=f[0],p=f[1];if(n)return Object(D.jsx)("h1",{children:"Community Loading"});if(s)return Object(D.jsx)("h1",{children:"Error Loading Community"});var g=function(){m.a.post("/api/follow?target_id=".concat(e)).then((function(){i()}))},w=function(){m.a.delete("/api/follow?target_id=".concat(e)).then((function(){i()}))};return Object(D.jsxs)("div",{children:[Object(D.jsxs)("div",{className:"comm-header f-width bg-comm",children:[o.logged_in?Object(D.jsx)("button",{className:o.user_following?"comm-button smooth-shadow-subtle round comm-button-subtle":"comm-button smooth-shadow-subtle round",onClick:function(){o.user_following?w():g()},children:o.user_following?"Unfollow":"Follow"}):Object(D.jsx)("p",{}),Object(D.jsx)("h1",{className:"comm-title",children:o.title}),o.logged_in&&Object(D.jsx)("button",{className:"comm-button smooth-shadow-subtle round",onClick:function(){p(!0)},children:"Create Post"})]}),Object(D.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr"},children:[Object(D.jsx)(T,{handlePostClick:function(e){b(e)}}),Object(D.jsx)(X,{setBlank:function(){b("")},postID:d},d)]}),Object(D.jsx)(E.a,{overlayClassName:"modal-overlay",className:"modal smooth-shadow",isOpen:O,onRequestClose:function(){p(!1)},children:Object(D.jsx)(Z,{submitPost:function(t,n){m.a.post("/api/post",{title:t,content:n,community:e}).then((function(e){a()})),p(!1)}})})]})}),ee=function(e){var t,n=e.commData;e.place;return Object(D.jsx)(a.b,{style:{textDecoration:"none"},to:"/community/".concat(n.id),children:Object(D.jsxs)(R.a.div,{initial:{scale:0},animate:{scale:1},transition:{duration:.1},className:"comm-preview smooth-shadow-small round",children:[Object(D.jsx)("h2",{children:n.title}),Object(D.jsx)("p",{children:(t=n.sidebar,t.length<40?t:"".concat(t.substring(0,37),"..."))}),Object(D.jsxs)("p",{className:"comm-preview-followers",children:[n.followers," Followers"]})]})})},te=function(){var e=N(),t=e.isLoading,n=e.isError,c=e.data;if(console.log(c),t)return Object(D.jsx)("h1",{children:"Loading"});if(n)return Object(D.jsx)("h1",{children:"Error Loading Communities"});return Object(D.jsx)("div",{className:"comm-container",children:c.logged_in?c.communities.map((function(e){return Object(D.jsx)(ee,{commData:e},e.id)})):Object(D.jsx)("h1",{children:"Log in to see your subscribed Communities"})})},ne=function(){var e=_(),t=e.isLoading,n=e.isError,c=e.data;if(t)return Object(D.jsx)("h1",{children:"Loading"});if(n)return Object(D.jsx)("h1",{children:"Error Loading Communities"});return Object(D.jsx)("div",{className:"comm-container",children:c.map((function(e,t){return Object(D.jsx)(ee,{place:t,commData:e},e.id)}))})},ce=n(122),se=function(){var e=Object(c.useState)(""),t=Object(u.a)(e,2),n=t[0],s=t[1],o=Object(c.useState)(""),i=Object(u.a)(o,2),a=i[0],r=i[1],l=P(a),j=l.isLoading,d=l.isError,b=l.data;if(j)return Object(D.jsx)("h1",{children:"Loading"});if(d)return Object(D.jsx)("h1",{children:"Error Loading Communities"});return Object(D.jsxs)("div",{children:[Object(D.jsx)("input",{className:"comm-search-bar",onChange:function(e){s(e.target.value)},value:n,type:"text"}),Object(D.jsx)("button",{className:"comm-search-button",onClick:function(){n.length>2&&r(n)},children:Object(D.jsx)(ce.a,{size:28,color:"#ffffff",weight:"bold"})}),Object(D.jsx)("div",{className:"comm-container",children:b.map((function(e){return Object(D.jsx)(ee,{commData:e},e.id)}))})]})},oe=function(){var e=Object(c.useState)("sub"),t=Object(u.a)(e,2),n=t[0],s=t[1],o=function(e){s(e)};return Object(D.jsxs)("div",{children:[Object(D.jsxs)("div",{className:"f-width tab-container",children:[Object(D.jsx)("button",{className:"tab",onClick:function(){o("sub")},disabled:"sub"===n,children:"Subbed"}),Object(D.jsx)("button",{className:"tab",onClick:function(){o("rec")},disabled:"rec"===n,children:"Recommended"}),Object(D.jsx)("button",{className:"tab",onClick:function(){o("src")},disabled:"src"===n,children:"Search"})]}),function(){switch(n){case"sub":return Object(D.jsx)(te,{});case"rec":return Object(D.jsx)(ne,{});case"src":return Object(D.jsx)(se,{});default:return Object(D.jsx)("h1",{children:"Error"})}}()]})},ie=new l.QueryClient;var ae=function(){return Object(D.jsx)("div",{className:"App",children:Object(D.jsx)(l.QueryClientProvider,{client:ie,children:Object(D.jsxs)(a.a,{children:[Object(D.jsx)(V,{}),Object(D.jsxs)(r.c,{children:[Object(D.jsx)(r.a,{path:"/community/:comm_id",children:Object(D.jsx)($,{})}),Object(D.jsx)(r.a,{children:Object(D.jsx)(oe,{path:"/"})})]})]})})})};i.a.render(Object(D.jsx)(s.a.StrictMode,{children:Object(D.jsx)(ae,{})}),document.getElementById("root"))},74:function(e,t,n){},75:function(e,t,n){}},[[111,1,2]]]);
//# sourceMappingURL=main.1a0c5fe4.chunk.js.map